(()=>{var e={};e.id=636,e.ids=[636],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},84770:e=>{"use strict";e.exports=require("crypto")},92761:e=>{"use strict";e.exports=require("node:async_hooks")},6005:e=>{"use strict";e.exports=require("node:crypto")},42877:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>s.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>c,routeModule:()=>p,tree:()=>d}),t(40938),t(36663),t(35866),t(11506);var a=t(23191),n=t(88716),i=t(37922),s=t.n(i),o=t(95231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);t.d(r,l);let d=["",{children:["(protected)",{children:["admin",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,40938)),"C:\\Users\\Roger\\RPCClientPortal\\app\\(protected)\\admin\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,36663)),"C:\\Users\\Roger\\RPCClientPortal\\app\\(protected)\\admin\\layout.tsx"]}]},{"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,11506)),"C:\\Users\\Roger\\RPCClientPortal\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\Roger\\RPCClientPortal\\app\\(protected)\\admin\\page.tsx"],m="/(protected)/admin/page",u={require:t,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/(protected)/admin/page",pathname:"/admin",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},48811:(e,r,t)=>{let a={"302aa1cc329ea82f1769a7b073f41c968f8e5e8d":()=>Promise.resolve().then(t.bind(t,8413)).then(e=>e.invalidateCacheAction)};async function n(e,...r){return(await a[e]()).apply(null,r)}e.exports={"302aa1cc329ea82f1769a7b073f41c968f8e5e8d":n.bind(null,"302aa1cc329ea82f1769a7b073f41c968f8e5e8d")}},99850:(e,r,t)=>{Promise.resolve().then(t.bind(t,20117)),Promise.resolve().then(t.bind(t,16566)),Promise.resolve().then(t.bind(t,91721)),Promise.resolve().then(t.bind(t,72248))},43036:(e,r,t)=>{Promise.resolve().then(t.bind(t,81015))},67833:(e,r,t)=>{Promise.resolve().then(t.bind(t,66377)),Promise.resolve().then(t.bind(t,12899)),Promise.resolve().then(t.bind(t,20117)),Promise.resolve().then(t.bind(t,16566)),Promise.resolve().then(t.bind(t,91721)),Promise.resolve().then(t.bind(t,72248)),Promise.resolve().then(t.t.bind(t,79404,23))},71843:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,12994,23)),Promise.resolve().then(t.t.bind(t,96114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,79671,23)),Promise.resolve().then(t.t.bind(t,41868,23)),Promise.resolve().then(t.t.bind(t,84759,23))},81015:(e,r,t)=>{"use strict";t.d(r,{PlanTierForm:()=>o});var a=t(10326),n=t(17577),i=t(90772),s=t(35047);function o({organizationId:e,currentPlanTier:r}){let t=(0,s.useRouter)(),[o,l]=(0,n.useState)(r),[d,c]=(0,n.useState)(!1),m=async r=>{r.preventDefault(),c(!0);try{if(!(await fetch(`/api/admin/organizations/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({plan_tier:o})})).ok)throw Error("Failed to update plan tier");t.refresh()}catch(e){console.error("Error updating plan tier:",e),alert("Failed to update plan tier. Please try again.")}finally{c(!1)}};return(0,a.jsxs)("form",{onSubmit:m,className:"flex items-center gap-2",children:[(0,a.jsxs)("select",{value:o,onChange:e=>l(e.target.value),className:"px-3 py-1.5 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",disabled:d,children:[a.jsx("option",{value:"FREE",children:"Free"}),a.jsx("option",{value:"STANDARD",children:"Standard"}),a.jsx("option",{value:"PREMIUM",children:"Premium"})]}),o!==r&&a.jsx(i.z,{type:"submit",size:"sm",disabled:d,children:d?"Saving...":"Update"})]})}},66377:(e,r,t)=>{"use strict";t.d(r,{OrganizationSwitcher:()=>i});var a=t(10326),n=t(66775);function i(){return a.jsx(n.Li,{appearance:{elements:{organizationSwitcherTrigger:"px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-md"}},createOrganizationMode:"navigation",createOrganizationUrl:"/app",afterCreateOrganizationUrl:"/app",afterSelectOrganizationUrl:"/app",afterSelectPersonalUrl:"/app"})}},12899:(e,r,t)=>{"use strict";t.d(r,{Sidebar:()=>p});var a=t(10326),n=t(90434),i=t(35047),s=t(60982),o=t(3719),l=t(75231),d=t(91310),c=t(77863);let m=[{name:"Dashboard",href:"/app",icon:s.Z},{name:"Documents",href:"/app/documents",icon:o.Z},{name:"Settings",href:"/app/settings",icon:l.Z}],u=[{name:"Organizations",href:"/admin",icon:d.Z}];function p({isAdmin:e=!1}){let r=(0,i.usePathname)();return a.jsx("div",{className:"flex flex-col w-64 bg-gray-50 border-r border-gray-200",children:a.jsx("nav",{className:"flex-1 px-2 py-4 space-y-1",children:(e?u:m).map(e=>{let t=r===e.href||r?.startsWith(e.href+"/");return(0,a.jsxs)(n.default,{href:e.href,className:(0,c.cn)("group flex items-center px-3 py-2 text-sm font-medium rounded-md",t?"bg-primary-50 text-primary-700":"text-gray-700 hover:bg-gray-100 hover:text-gray-900"),children:[a.jsx(e.icon,{className:(0,c.cn)("mr-3 h-5 w-5 flex-shrink-0",t?"text-primary-500":"text-gray-400 group-hover:text-gray-500")}),e.name]},e.name)})})})}},90772:(e,r,t)=>{"use strict";t.d(r,{z:()=>s});var a=t(10326),n=t(17577),i=t(77863);let s=(0,n.forwardRef)(({className:e,variant:r="default",size:t="md",...n},s)=>a.jsx("button",{className:(0,i.cn)("inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{default:"bg-primary-600 text-white hover:bg-primary-700 focus-visible:ring-primary-500",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus-visible:ring-primary-500",ghost:"text-gray-700 hover:bg-gray-100 focus-visible:ring-primary-500",danger:"bg-red-600 text-white hover:bg-red-700 focus-visible:ring-red-500"}[r],{sm:"h-8 px-3 text-sm",md:"h-10 px-4 py-2",lg:"h-12 px-6 text-lg"}[t],e),ref:s,...n}));s.displayName="Button"},77863:(e,r,t)=>{"use strict";t.d(r,{cn:()=>i});var a=t(41135),n=t(31009);function i(...e){return(0,n.m6)((0,a.W)(e))}},36663:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>l});var a=t(19510),n=t(58585),i=t(90455),s=t(20169),o=t(88806);async function l({children:e}){try{await (0,i.Fo)()}catch(e){(0,n.redirect)("/app")}return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[a.jsx(s.w,{showOrgSwitcher:!1}),(0,a.jsxs)("div",{className:"flex",children:[a.jsx(o.Y,{isAdmin:!0}),a.jsx("main",{className:"flex-1",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e})})]})]})}},40938:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>u});var a=t(19510),n=t(90455),i=t(9487),s=t(99651),o=t(46697),l=t(18897),d=t(65313),c=t(50650);let m=(0,t(68570).createProxy)(String.raw`C:\Users\Roger\RPCClientPortal\components\features\PlanTierForm.tsx#PlanTierForm`);async function u(){await (0,n.Fo)();let e=await i.db.organization.findMany({orderBy:{created_at:"desc"}}),r=await Promise.all(e.map(async e=>{try{let r=await (0,s.N)().organizations.getOrganizationMembershipList({organizationId:e.clerk_org_id});return{...e,memberCount:r.data.length}}catch(r){return console.error(`Error fetching members for org ${e.clerk_org_id}:`,r),{...e,memberCount:0}}}));return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Organizations"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Manage all client organizations and their plan tiers"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-6",children:[r.map(e=>(0,a.jsxs)(o.Zb,{children:[a.jsx(o.Ol,{children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx(o.ll,{children:e.name}),(0,a.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[a.jsx(l.C,{variant:"info",children:(0,d.su)(e.plan_tier)}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[e.memberCount," member",1!==e.memberCount?"s":""]})]})]}),a.jsx(m,{organizationId:e.id,currentPlanTier:e.plan_tier})]})}),a.jsx(o.aY,{children:(0,a.jsxs)("dl",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[a.jsx("dt",{className:"font-medium text-gray-500",children:"Clerk Org ID"}),a.jsx("dd",{className:"mt-1 text-gray-900 font-mono text-xs",children:e.clerk_org_id})]}),(0,a.jsxs)("div",{children:[a.jsx("dt",{className:"font-medium text-gray-500",children:"Created"}),a.jsx("dd",{className:"mt-1 text-gray-900",children:(0,c.p)(e.created_at)})]})]})})]},e.id)),0===r.length&&a.jsx(o.Zb,{children:a.jsx(o.aY,{className:"pt-6",children:a.jsx("div",{className:"text-center py-8",children:a.jsx("p",{className:"text-gray-500",children:"No organizations found."})})})})]})]})}},11506:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>l,metadata:()=>o});var a=t(19510),n=t(77366),i=t.n(n),s=t(7311);t(67272);let o={title:"RPC Associates - Client Portal",description:"Client portal for RPC Associates accounting, consulting, and tech solutions"};function l({children:e}){return a.jsx(s.El,{children:a.jsx("html",{lang:"en",children:a.jsx("body",{className:i().className,children:e})})})}},20169:(e,r,t)=>{"use strict";t.d(r,{w:()=>o});var a=t(19510),n=t(63508),i=t(57371);let s=(0,t(68570).createProxy)(String.raw`C:\Users\Roger\RPCClientPortal\components\layout\OrganizationSwitcher.tsx#OrganizationSwitcher`);function o({showOrgSwitcher:e=!0}){return a.jsx("nav",{className:"bg-white border-b border-gray-200",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between h-16",children:[a.jsx("div",{className:"flex items-center",children:a.jsx(i.default,{href:"/app",className:"text-xl font-bold text-gray-900",children:"RPC Associates"})}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[e&&a.jsx(s,{}),a.jsx(n.l8,{afterSignOutUrl:"/"})]})]})})})}},88806:(e,r,t)=>{"use strict";t.d(r,{Y:()=>a});let a=(0,t(68570).createProxy)(String.raw`C:\Users\Roger\RPCClientPortal\components\layout\Sidebar.tsx#Sidebar`)},18897:(e,r,t)=>{"use strict";t.d(r,{C:()=>s});var a=t(19510),n=t(71159),i=t(50650);let s=(0,n.forwardRef)(({className:e,variant:r="default",...t},n)=>a.jsx("div",{ref:n,className:(0,i.cn)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium",{default:"bg-gray-100 text-gray-800",success:"bg-green-100 text-green-800",warning:"bg-yellow-100 text-yellow-800",danger:"bg-red-100 text-red-800",info:"bg-blue-100 text-blue-800"}[r],e),...t}));s.displayName="Badge"},46697:(e,r,t)=>{"use strict";t.d(r,{Ol:()=>o,SZ:()=>d,Zb:()=>s,aY:()=>c,ll:()=>l});var a=t(19510),n=t(71159),i=t(50650);let s=(0,n.forwardRef)(({className:e,...r},t)=>a.jsx("div",{ref:t,className:(0,i.cn)("rounded-lg border border-gray-200 bg-white text-gray-950 shadow-sm",e),...r}));s.displayName="Card";let o=(0,n.forwardRef)(({className:e,...r},t)=>a.jsx("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...r}));o.displayName="CardHeader";let l=(0,n.forwardRef)(({className:e,...r},t)=>a.jsx("h3",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",e),...r}));l.displayName="CardTitle";let d=(0,n.forwardRef)(({className:e,...r},t)=>a.jsx("p",{ref:t,className:(0,i.cn)("text-sm text-gray-500",e),...r}));d.displayName="CardDescription";let c=(0,n.forwardRef)(({className:e,...r},t)=>a.jsx("div",{ref:t,className:(0,i.cn)("p-6 pt-0",e),...r}));c.displayName="CardContent",(0,n.forwardRef)(({className:e,...r},t)=>a.jsx("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",e),...r})).displayName="CardFooter"},90455:(e,r,t)=>{"use strict";t.d(r,{Fo:()=>l,xV:()=>s});var a=t(78459),n=t(9487);async function i(){let{userId:e}=await (0,a.I)();return e}async function s(){let e=await i();if(!e)return null;let r=await n.db.userProfile.findUnique({where:{clerk_user_id:e}});return r||(r=await n.db.userProfile.create({data:{clerk_user_id:e,is_firm_super_admin:!1,is_firm_staff:!1}})),r}async function o(){let e=await i();if(!e)throw Error("Unauthorized: Authentication required");return e}async function l(){await o();let e=await s();if(!e)throw Error("Unauthorized: User profile not found");if(!e.is_firm_super_admin&&!e.is_firm_staff)throw Error("Unauthorized: Firm admin or staff role required");return e}},9487:(e,r,t)=>{"use strict";t.d(r,{db:()=>n});var a=t(53524);let n=globalThis.prisma??new a.PrismaClient({log:["error"]})},65313:(e,r,t)=>{"use strict";function a(e){return{advancedReports:"STANDARD"===e||"PREMIUM"===e,secureChat:"STANDARD"===e||"PREMIUM"===e,bulkOperations:"PREMIUM"===e,customBranding:"PREMIUM"===e,apiAccess:"PREMIUM"===e,prioritySupport:"PREMIUM"===e,advancedAnalytics:"PREMIUM"===e}}function n(e){switch(e){case"FREE":return"Free";case"STANDARD":return"Standard";case"PREMIUM":return"Premium";default:return e}}t.d(r,{BZ:()=>a,su:()=>n})},50650:(e,r,t)=>{"use strict";t.d(r,{S:()=>o,cn:()=>i,p:()=>s});var a=t(55761),n=t(62386);function i(...e){return(0,n.m6)((0,a.W)(e))}function s(e){let r="string"==typeof e?new Date(e):e;return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"numeric"}).format(r)}function o(e){let r="string"==typeof e?new Date(e):e,t=Math.floor((new Date().getTime()-r.getTime())/1e3);if(t<60)return"just now";let a=Math.floor(t/60);if(a<60)return`${a} minute${a>1?"s":""} ago`;let n=Math.floor(a/60);if(n<24)return`${n} hour${n>1?"s":""} ago`;let i=Math.floor(n/24);return i<30?`${i} day${i>1?"s":""} ago`:s(r)}},67272:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[342,459,246,651,956,881],()=>t(42877));module.exports=a})();